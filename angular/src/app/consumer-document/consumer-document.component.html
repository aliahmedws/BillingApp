<abp-page [title]="'::Menu:ConsumerDocuments' | abpLocalization">
  <abp-page-toolbar-container class="col">
    <div class="text-end">
      <button id="create" class="btn btn-outline-primary btn-sm" type="button" (click)="navigateToCreate()">
        <i class="fa fa-plus me-1"></i> {{ '::NewDocument' | abpLocalization }}
      </button>
    </div>
  </abp-page-toolbar-container>

  <!-- Search + Filters -->
  <div class="card">
    <div class="card-body">
      <div class="row align-items-center">
        <div class="col-10">
          <div class="input-group">
            <input
              type="text"
              class="form-control"
              [placeholder]="'::SearchHere' | abpLocalization"
            />
            <button type="button" class="btn btn-primary">
              <i class="fa fa-search"></i>
            </button>
          </div>
        </div>
        <div class="col-2 text-end">
          <button class="btn btn-outline-primary w-100" (click)="showFilter = !showFilter">
            {{ '::Filters' | abpLocalization }}
            <i class="fas" [ngClass]="showFilter ? 'fa-angle-up' : 'fa-angle-down'"></i>
          </button>
        </div>
      </div>

      <!-- Filter Panel -->
      <div *ngIf="showFilter" class="mt-2">
        <div class="row g-2">
          <div class="col-sm-3">
            <label>{{ '::FirstName' | abpLocalization }}</label>
            <input class="form-control form-control-sm" [(ngModel)]="filters.firstName" />
          </div>
          <div class="col-sm-3">
            <label>{{ '::LastName' | abpLocalization }}</label>
            <input class="form-control form-control-sm" [(ngModel)]="filters.lastName" />
          </div>
          <div class="col-sm-3">
            <label>{{ '::CNIC' | abpLocalization }}</label>
            <input class="form-control form-control-sm" [(ngModel)]="filters.cnic" />
          </div>
          <div class="col-sm-3">
            <label>{{ '::Gender' | abpLocalization }}</label>
            <nz-select
              [(ngModel)]="filters.gender"
              nzAllowClear
              nzShowSearch
              class="form-control"
              class="w-100"
            >
              <nz-option [nzValue]="null" [nzLabel]="'::All' | abpLocalization"></nz-option>
              <nz-option [nzValue]="1" [nzLabel]="'::Enum:Gender:1' | abpLocalization"></nz-option>
              <nz-option [nzValue]="2" [nzLabel]="'::Enum:Gender:2' | abpLocalization"></nz-option>
              <nz-option [nzValue]="3" [nzLabel]="'::Enum:Gender:3' | abpLocalization"></nz-option>
            </nz-select>
          </div>

          <div class="col-sm-auto d-flex align-items-end gap-1">
            <button type="button" class="btn btn-sm btn-outline-primary" (click)="clearFilters()">
              <i class="fas fa-undo"></i> {{ '::Reset' | abpLocalization }}
            </button>
            <button type="button" class="btn btn-primary btn-sm" (click)="list.get()">
              <i class="fa fa-filter"></i> {{ '::Apply' | abpLocalization }}
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Table -->
  <div class="card mt-2">
    <div class="card-body">
      <ngx-datatable  default>
        <!-- Actions -->
        <ngx-datatable-column [name]="'::Actions' | abpLocalization" [maxWidth]="150" [sortable]="false">
          <ng-template let-row="row" ngx-datatable-cell-template>
            <div ngbDropdown container="body" class="d-inline-block">
              <button class="btn btn-primary btn-sm dropdown-toggle" ngbDropdownToggle>
                <i class="fa fa-cog me-1"></i>{{ '::Actions' | abpLocalization }}
              </button>
              <div ngbDropdownMenu>
                <button *abpPermission="'Billing.ConsumerPersonalInfos.Edit'" ngbDropdownItem (click)="editConsumer(row.id)">
                  {{ '::Edit' | abpLocalization }}
                </button>
                <button *abpPermission="'Billing.ConsumerPersonalInfos.Delete'" ngbDropdownItem (click)="delete(row.id)">
                  {{ '::Delete' | abpLocalization }}
                </button>
                 <button *abpPermission="'Billing.ConsumerPersonalInfos.View'" ngbDropdownItem (click)="viewConsumer(row.id)">
                  {{ '::View' | abpLocalization }}
                </button>
              </div>
            </div>
          </ng-template>
        </ngx-datatable-column>

        <!-- Columns -->
        <ngx-datatable-column [name]="'::FirstName' | abpLocalization" prop="firstName"></ngx-datatable-column>
        <ngx-datatable-column [name]="'::LastName' | abpLocalization" prop="lastName"></ngx-datatable-column>
        <ngx-datatable-column [name]="'::Phone' | abpLocalization" prop="phone"></ngx-datatable-column>
        <ngx-datatable-column [name]="'::CNIC' | abpLocalization" prop="cnic"></ngx-datatable-column>
        <ngx-datatable-column [name]="'::Gender' | abpLocalization" prop="gender">
          <ng-template let-row="row" ngx-datatable-cell-template>
            {{ ('::Enum:Gender:' + row.gender) | abpLocalization }}
          </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column [name]="'::Email' | abpLocalization" prop="email"></ngx-datatable-column>
      </ngx-datatable>
    </div>
  </div>
</abp-page>

